---
layout: layouts/base.njk
showMaps: true
---

<!-- Bloc containing the map -->
<div id="map">
    <aside id="map-selection" 
           class="map-panel" 
           aria-labelledby="panel-title">
        <button id="open-panel-btn" 
                class="fr-btn fr-btn--icon-left fr-icon-eye-line map-panel-toggle" 
                aria-label="Ouvrir le panneau de sélection des cartes"
                aria-controls="control-panel"
                aria-expanded="true">
            Afficher les cartes
        </button>
        <div class="map-panel--extended">
            <div class="map-panel__header">
                <button class="fr-btn--close fr-btn" 
                        aria-label="Fermer le panneau de sélection des cartes"
                        aria-controls="control-panel">
                    Fermer
                </button>
            </div>
            <div class="map-panel__content">
                <h2 id="panel-title" class="fr-h5">Cartes</h2>
                {% if mapStyles and mapStyles.styles %}
                    {% for style in mapStyles.styles %}
                    <div class="map-card" 
                         data-style-url="{{ style.url }}"
                         {% if style.isDefault %}aria-current="true"{% endif %}
                         role="option">
                        <div class="map-card__header">
                            <span class="fr-icon-success-fill" aria-hidden="true"></span>
                            <div class="map-card__img">   
                                <img src="{{ style.thumbnail }}" class="fr-responsive-img" alt="Aperçu de {{ style.title }}" />
                            </div>
                        </div>
                        <div class="map-card__content">
                            <h3 class="map-card__title">{{ style.title }}</h3>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <p>No map styles available</p>
                {% endif %}
            </div>
        </div>
    </aside>
    {# <div class="map-panel">
        <p id="zoom-level"></p>
    </div> #}
</div>
<script>
    window.defaultMapStyle = {% if mapStyles and mapStyles.styles %}
        {% set defaultStyle = mapStyles.styles | find("isDefault", true) %}
        {% if defaultStyle %}'{{ defaultStyle.url }}'{% else %}null{% endif %}
    {% else %}null{% endif %};
</script>
<script type="text/javascript" src="/js/maps-viewer.js"></script>